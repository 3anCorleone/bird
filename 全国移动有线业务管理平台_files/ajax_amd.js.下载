/*! @version 1.0.10 */
define(["jquery","encrypt"],function(e,a){var t,n,i,c,s,p={SUCC:0},u={HTML:"html",JSON:"json",TEXT:"text"},l=6e4,f=(n=new RegExp("(^| )"+"lun"+"=([^;]*)(;|$)"),(t=document.cookie.match(n))?unescape(t[2]):"zh-CN"),d=function(e,t){var n,r,o="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),a=[];if(t=t||o.length,e)for(n=0;n<e;n++)a[n]=o[0|Math.random()*t];else for(a[8]=a[13]=a[18]=a[23]="-",a[14]="4",n=0;n<36;n++)a[n]||(r=0|16*Math.random(),a[n]=o[19==n?3&r|8:r]);return a.join("")},o=window.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest,y=function(e,t,n,r){return"function"==typeof e&&(r=n,n=t,t=e,e=""),{cmd:e,callback:t,sync:!!n,encrypt:!!r}},v=function(e,t){var n={_log4xContextKey:d(22,16),"x-expect-language":f};return s&&$.extend(n,s),$.extend({encrypt:!1,timeout:l,dataType:u.JSON,beforeSend:function(e){e.overrideMimeType("text/plain; charset=utf-8")},headers:n},e||{},{async:!0},t||{})},h=function(e,t){var n,r,o;return t=a.enc.Latin1.parse((n=16,r=" ",o=t,(o=Array(n+1).join(r)+o).slice(-n))),a.AES.encrypt(e,t,{iv:t,mode:a.mode.CBC,padding:a.pad.ZeroPadding}).toString()},m=function(e,t){if("string"==typeof t&&"object"==typeof e){var n,r=t.match(/[?|&]uid=([^&]+)/);if(r)n=r[1];else/^http/.test(t)||(t=x(t)),n=t.replace(/(https?:\/\/[^\/]+\/)|(\/)/,"").split("?")[0].slice(0,16);for(var o in e)value=e[o]+"",e[o]=h(value,n)}return e},x=function(e){var t=window.location.pathname.split("/"),n=e.split("/");if(""===n[0])return e;var r,o=1,a=[];for(var c in n){var u=n[c];".."==u?o++:"."==u||a.push(u)}return r=t.slice(0,t.length-o),[].concat(r,a).join("/")},T=function(e,t,n,r,o){var a={XMLHttpRequest:n,textStatus:t,errorThrown:r};if(i&&i[e.returnCode])return i[e.returnCode](e,t,n);if("BUSIOPER=RELOGIN"!=e.returnCode){var c=e.returnCode==p.SUCC;if(!o){var u=$.Deferred();return c?u.resolve(e,a):u.reject(e,a)}o(e,c,a)}else window.location.href="../../login.html"},j=function(e,t,n,r){if(c&&c[e.status])c[e.status](e,t,n);else{var o={returnCode:"404",returnMessage:"网络异常或超时，请稍候再试！"},a={XMLHttpRequest:e,textStatus:t,errorThrown:n};if(!r)return $.Deferred().reject(o,a);r(o,!1,a)}},g=function(e,t,r){var n="html"==r.dataType;r.encrypt&&t&&(t=m(t,e));var o=$.extend({url:e,data:t,cache:n},r);return $.ajax(o).then(function(e,t,n){if(e)return r.nativeAjax?function(e,t,n,r,o){var a={XMLHttpRequest:n,textStatus:t,errorThrown:r};if(i&&i[e.returnCode])i[e.returnCode](e,t,n);else{if("BUSIOPER=RELOGIN"!=e.returnCode)return o?void o(e,isSuc,a):$.Deferred().resolve(e,a);window.location.href="../../login.html"}}(e,t,n):T(e,t,n)},function(e,t,n){return j(e,t,n)})},S=function(e,t,n,r,o,a,c){var u="html"==r;c&&(n=m(n,e));var i={_log4xContextKey:d(22,16),"x-expect-language":f};return s&&$.extend(i,s),$.ajax({url:e,type:t,data:n,headers:i,cache:u,dataType:r,async:!a,timeout:l,beforeSend:function(e){e.overrideMimeType("text/plain; charset=utf-8")},success:function(e,t,n){e&&("html"==r&&o?o(e,!0):T(e,t,n,null,o))},error:function(e,t,n){j(e,t,n,o)}})};return{setHeader:function(e){s=e},codeHandle:function(e){i=e},statusHandle:function(e){c=e},getJson:function(e,t,n,r,o){var a=y(t,n,r,o);S(e,"GET",a.cmd,u.JSON,a.callback,a.sync,a.encrypt)},postJson:function(e,t,n,r,o){var a=y(t,n,r,o);S(e,"POST",a.cmd,u.JSON,a.callback,a.sync,a.encrypt)},putJson:function(e,t,n,r,o){var a=y(t,n,r,o);S(e,"PUT",a.cmd,u.JSON,a.callback,a.sync,a.encrypt)},deleteJson:function(e,t,n,r,o){var a=y(t,n,r,o);S(e,"DELETE",a.cmd,u.JSON,a.callback,a.sync,a.encrypt)},getJsonp:function(e,t,n,r){var o,a,c,u,i;a="GET",c=t,u=n,i=r,(o=e)&&""!==o?u&&""!==u?(c&&""!==c||console.log("warn! your passed null or empty to cmd param, are you suer?"),$.ajax({url:o,type:a,data:c,jsonpCallback:"jsonCallback",contentType:"application/json",dataType:"jsonp",async:!i,timeout:l,beforeSend:function(e){e.overrideMimeType("text/plain; charset=utf-8")},success:function(e,t,n){e&&T(e,t,n,null,u)},error:function(e,t,n){j(e,t,n,u)}})):console.log("you missed callback, it must be a function"):console.log("the url of param cann't equals null or empty of string")},ajax:function(e){var t=$.extend({type:"post",dataType:"json",timeout:3e4,beforeSend:function(e){e.overrideMimeType("text/plain; charset=utf-8")}},e);return $.ajax(t)},getJsonAsync:function(e,t,n){var r=v(n,{type:"GET"});return g(e,t,r)},postJsonAsync:function(e,t,n){var r=v(n,{type:"POST"});return g(e,t,r)},putJsonAsync:function(e,t,n){var r=v(n,{type:"PUT"});return g(e,t,r)},deleteJsonAsync:function(e,t,n){var r=v(n,{type:"DELETE"});return g(e,t,r)},corsAsync:this.cors,corsNative:function(e,t,n){"object"==typeof e&&(e=(n=e).url,t=n.data),n=$.extend({url:e,data:t},n),$.support&&($.support.cors=!0),o&&(n.xhrFields={withCredentials:!0});var r=v(n,{crossDomain:!0,headers:n&&n.headers||{},contentType:"application/json; charset=utf-8"});return r.type||(r.type="post"),r.nativeAjax=!0,g(e,t,r)},cors:function(e,t,n){"object"==typeof e&&(e=(n=e).url,t=n.data),$.support&&($.support.cors=!0);var r=v(n,{crossDomain:!0,headers:n&&n.headers||{},contentType:"application/json; charset=utf-8"});return r.type||(r.type="post"),g(e,t,r)}}});